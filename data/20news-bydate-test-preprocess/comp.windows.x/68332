from iop server iie ncku edu tw subject program wm_protocol open look toolkit organ casd lab line hi all studi book unix desktop guid open look there exampl winprop demonstr program wm_protocol properti chapter it run show the static text messag notic pop_up what problem thank advanc help iop file winprop show set properti window includ xatom for definit xa_atom includ intrins includ stringdef includ xol openlook includ xol statictext includ xol oblongbutt includ xol notic thi file defin atom prefix id top level noticeshel widget static widget top_level notice_shel static widget make_notic static char messag client use properti commun with window manag thi exampl illustr open look applic request notif window manag when certain event occur the commun form clientmessag event applic process event handler atom use inter client commun atom static void static void save_and_exit static void save_yourself static void pop_notic static void do_exit string hold comand line for use respond to protocol messag char saved_cmdlin void main argc argv int argc char argv widget int save command line use respond the protocol messag sprintf saved_cmdlin argv if argc for argc strcat saved_cmdlin argv strcat saved_cmdlin creat initi top level widget top_level oliniti argv ol_main null argc argv creat statictext widget stext top_level xtnstring messag xtnwidth null creat noticeshel widget later use make_notic top_level intern atom xinternatom xtdisplay wm_protocol fals xinternatom xtdisplay fals xinternatom xtdisplay fals add event handler process clientmessag event sent window manag top_level noeventmask true null realiz widget start process event xtrealizewidget top_level append properti definit wm_protocol properti thi step requir window id top level widget the window id valid widget realiz xchangeproperti xtdisplay top_level xtwindow top_level xa_atom propmodeappend xchangeproperti xtdisplay top_level xtwindow top_level xa_atom propmodeappend xtmainloop static void client_data p_event widget xtpointer client_data xevent p_event if p_event type clientmessag p_event xclient message_typ if p_event xclient data save_and_exit if p_event xclient data save_yourself static void save_and_exit display notic give user chanc respond pop_notic top_level notice_shel static void save_yourself set wm_command properti save command line xchangeproperti xtdisplay top_level xtwindow top_level xa_wm_command xa_str propmodereplac saved_cmdlin strlen saved_cmdlin static widget make_notic parent widget parent widget n_text n_control n_exit n_cancel creat button provid callback pop notic quitbutton parent xtnlabel exit null xtaddcallback xtnselect pop_notic null creat noticeshel widget note use instead usual notice_shel quitnotic null get id text control area widget the noticeshel xtvagetvalu notice_shel xtntextarea n_text xtncontrolarea n_control null place messag text area noticeshel xtvasetvalu n_text xtnstring pleas confirm exit program null add button control area noticeshel each button appropri callback n_exit noticeexit n_control xtnlabel exit null xtaddcallback n_exit xtnselect do_exit null n_cancel noticecancel n_control xtnlabel cancel xtndefault true null return static void pop_notic w_eman w_notic widget w_eman w_notic xtvasetvalu w_notic w_eman null pop noticeshel widget the noticeshel widget make sure aplic wait user select from one button noticeshel control area xtpopup w_notic xtgrabexclus static void do_exit call_data client_data widget xtpointer call_data client_data xclosedisplay xtdisplay exit